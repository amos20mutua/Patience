<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Anime.js for magical animation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <meta charset="UTF-8">
  <title>Happy Birthday Patience üéâ | CS Dreamer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Custom Tailwind config for girlish/futuristic colors -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            accent: '#e879f9', // soft pink
            tech: '#38bdf8',   // cyan
            darkbg: '#18181b', // dark background
            sparkle: '#f472b6', // pink sparkle
          },
          fontFamily: {
            techno: ['"Share Tech Mono"', 'monospace'],
            script: ['"Pacifico"', 'cursive'],
          },
          boxShadow: {
            glow: '0 0 16px 2px #e879f9, 0 0 32px 4px #38bdf8',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            twinkle: {
              '0%, 100%': { opacity: 0.7 },
              '50%': { opacity: 1 },
            },
          },
          animation: {
            float: 'float 3s ease-in-out infinite',
            twinkle: 'twinkle 2s ease-in-out infinite',
          }
        }
      }
    }
  </script>
  <!-- Google Fonts for extra style -->
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Pacifico&display=swap" rel="stylesheet">
  <style>
        .voucher-card, .glass-card {
          background: rgba(255,255,255,0.18);
          backdrop-filter: blur(14px);
          border-radius: 22px;
          box-shadow: 0 8px 32px rgba(80,0,120,0.18), 0 2px 8px rgba(232,121,249,0.12);
          border: 1.5px solid rgba(255,255,255,0.32);
          transition: box-shadow 0.3s, transform 0.3s;
          position: relative;
          overflow: visible;
        }
        .voucher-card:hover { transform: scale(1.05); }
        .voucher-card h2 { color: #fff; }
        .voucher-btn {
          background: linear-gradient(90deg, #e879f9 0%, #38bdf8 100%);
          color: #fff;
          border: none;
          border-radius: 999px;
          padding: 0.7rem 1.5rem;
          font-weight: 600;
          font-size: 1rem;
          box-shadow: 0 2px 8px rgba(56,189,248,0.12);
          cursor: pointer;
          transition: background 0.2s, transform 0.2s;
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }
        .voucher-btn:hover { background: linear-gradient(90deg, #38bdf8 0%, #e879f9 100%); transform: scale(1.07);}
        #sparkle-container {
          pointer-events: none;
          position: absolute;
          left: 0; top: 0; width: 100%; height: 100%;
          z-index: 2;
        }
        @media (max-width: 600px) {
          .voucher-card { padding: 1rem; }
          iframe { min-height: 140px !important; }
        }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { width: 100%; overflow-x: hidden; }
    .container { display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem; padding: 1rem; }
    .card, .future-card {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 1rem;
      width: 90%;
      max-width: 340px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,255,255,0.3);
      transition: transform 0.3s;
    }
    .card:hover, .future-card:hover { transform: scale(1.05); }
    .card h3, .card p, .card h2, .future-card h3, .future-card p, .future-card h2, .future-card span { color: #fff; }
    .countdown {
      background: rgba(255,255,255,0.18);
      backdrop-filter: blur(8px);
      border-radius: 18px;
      padding: 1rem;
      text-align: center;
      color: white;
      margin: auto;
      box-shadow: 0 6px 18px rgba(0,0,0,0.18);
    }
    button {
      padding: 0.7rem 1.2rem;
      border-radius: 50px;
      border: none;
      color: #fff;
      background: #0066ff;
      font-size: 1rem;
      cursor: pointer;
      display: block;
      margin: 0.7rem auto;
    }
    button:active { transform: scale(0.97); }
    ::-webkit-scrollbar {
      width: 8px;
      background: #232336;
    }
    ::-webkit-scrollbar-thumb {
      background: #e879f9;
      border-radius: 8px;
    }
    #particles {
      position: absolute;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }
  </style>
</head>
<body class="bg-darkbg min-h-screen flex items-center justify-center relative overflow-hidden font-techno">
  <!-- Animated Particles Background -->
  <canvas id="particles"></canvas>


  <!-- Main Section -->
  <main class="relative z-10 w-full max-w-lg mx-auto p-4 sm:p-8 flex flex-col items-center justify-center min-h-[90vh]">
    <!-- Progress Indicator -->
    <div id="progress" class="flex items-center justify-center mb-8 w-full"></div>
    <!-- Step Content -->
    <div id="step-content" class="w-full text-center transition-all duration-500"></div>
    <!-- Inline Voucher Section (hidden by default) -->
    <section id="voucherSection" style="display:none;">
      <div id="voucher-card" class="voucher-card relative mx-auto p-6 w-full max-w-md glass-card opacity-0 scale-90">
        <div id="sparkle-container"></div>
        <h2 class="text-2xl font-bold mb-2 text-center">üéâ Your Special Voucher üéâ</h2>
        <iframe src="voucher.pdf" class="w-full h-64 rounded-lg border border-accent bg-white mb-4" style="min-height:220px;"></iframe>
        <div class="flex justify-center gap-4 mt-2">
          <button id="voucher-download" class="voucher-btn">
            <span style="margin-right:0.5em;">&#128190;</span>Download
          </button>
          <button id="voucher-print" class="voucher-btn">
            <span style="margin-right:0.5em;">&#128424;</span>Print
          </button>
        </div>
      </div>
    </section>
  </main>

  <!-- Voucher PDF Modal -->
  <div id="pdf-modal" class="fixed inset-0 bg-black/60 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl shadow-lg max-w-md w-full p-4 relative flex flex-col items-center">
      <button id="close-modal" class="absolute top-2 right-2 text-gray-400 hover:text-accent text-2xl font-bold">&times;</button>
      <h3 class="text-lg font-bold text-tech mb-2">Your Voucher</h3>
      <iframe id="pdf-frame" src="" class="w-full h-80 rounded border border-accent mb-2" style="background:#f8fafc;"></iframe>
      <p class="text-sm text-gray-600 mb-2">This is your special birthday voucher. Download it in the next step.</p>
    </div>
  </div>

  <script>
    // --- PARTICLES ANIMATION (Stars & Sparkles) ---
    const canvas = document.getElementById('particles');
    const ctx = canvas.getContext('2d');
    let particles = [];
    const PARTICLE_COUNT = 36;
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function randomColor() {
      // Soft pink, blue, and white sparkles
      const colors = ['#e879f9', '#38bdf8', '#fff', '#f472b6'];
      return colors[Math.floor(Math.random() * colors.length)];
    }

    function createParticle() {
      const size = Math.random() * 1.8 + 1.2;
      return {
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        vx: (Math.random() - 0.5) * 0.18,
        vy: (Math.random() - 0.5) * 0.18,
        size,
        color: randomColor(),
        twinkle: Math.random() * Math.PI * 2,
      };
    }

    function drawParticle(p) {
      ctx.save();
      ctx.globalAlpha = 0.7 + 0.3 * Math.sin(Date.now() / 700 + p.twinkle);
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, 2 * Math.PI);
      ctx.fillStyle = p.color;
      ctx.shadowColor = p.color;
      ctx.shadowBlur = 8;
      ctx.fill();
      ctx.restore();
    }

    function animateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let p of particles) {
        p.x += p.vx;
        p.y += p.vy;
        // Wrap around edges
        if (p.x < 0) p.x = canvas.width;
        if (p.x > canvas.width) p.x = 0;
        if (p.y < 0) p.y = canvas.height;
        if (p.y > canvas.height) p.y = 0;
        drawParticle(p);
      }
      requestAnimationFrame(animateParticles);
    }

    // Initialize particles
    particles = Array.from({length: PARTICLE_COUNT}, createParticle);
    animateParticles();

    // --- INTERACTIVE STEPS LOGIC ---
    // Steps: Welcome, Why CS, UoN, Pause & Breathe, Reveal Cards, Loading, View PDF, Download PDF, Congratulate
    const steps = [
      {
        title: "Welcome Patience üëã",
        content: `
          <h1 class="text-3xl sm:text-4xl font-bold text-accent mb-2 animate-fadeIn">Happy Birthday, Patience!</h1>
          <p class="text-tech text-lg mb-6 animate-fadeIn delay-100">You were created with intention. Your journey is guided by purpose and peace.</p>
          <div class="flex flex-col items-center">
            <button class="hold-btn px-6 py-2 rounded-full bg-accent/90 text-darkbg font-bold shadow-glow transition-all duration-500 animate-fadeIn delay-200 relative overflow-hidden">
              <span class="hold-btn-label relative z-10">Begin</span>
              <span class="hold-btn-fill absolute left-0 top-0 h-full bg-tech/60 rounded-full z-0" style="width:0%"></span>
            </button>
          </div>
        `
      },
      {
        title: "Why Computer Science? üíª",
        content: `
          <h2 class="text-2xl font-bold text-tech mb-2 animate-fadeIn">Problem-Solving with Purpose</h2>
          <ul class="mb-6 text-accent text-lg space-y-1 animate-fadeIn delay-100">
            <li>‚Ä¢ Wisdom, diligence, and curiosity will take you far.</li>
            <li>‚Ä¢ You bring calm confidence to every challenge.</li>
            <li>‚Ä¢ Computer science is more than code‚Äîit's building with meaning.</li>
          </ul>
          <div class="flex flex-col items-center">
            <button class="hold-btn px-6 py-2 rounded-full bg-tech/80 text-darkbg font-bold shadow-glow transition-all duration-500 animate-fadeIn delay-200 relative overflow-hidden">
              <span class="hold-btn-label relative z-10">Next</span>
              <span class="hold-btn-fill absolute left-0 top-0 h-full bg-accent/40 rounded-full z-0" style="width:0%"></span>
            </button>
          </div>
        `
      },
      {
        title: "Your Journey to UoN üöÄ",
        content: `
          <h2 class="text-2xl font-bold text-accent mb-2 animate-fadeIn">A Calling to Grow</h2>
          <p class="text-tech text-lg mb-6 animate-fadeIn delay-100">Nairobi awaits. Your gifts, your faith, your dreams‚Äîguided by grace, ready to flourish.</p>
          <div class="flex flex-col items-center">
            <button class="hold-btn px-6 py-2 rounded-full bg-accent/90 text-darkbg font-bold shadow-glow transition-all duration-500 animate-fadeIn delay-200 relative overflow-hidden">
              <span class="hold-btn-label relative z-10">Next</span>
              <span class="hold-btn-fill absolute left-0 top-0 h-full bg-tech/40 rounded-full z-0" style="width:0%"></span>
            </button>
          </div>
        `
      },
      {
        title: "Pause & Breathe ü§ç",
        content: `
          <div class="flex flex-col items-center justify-center animate-fadeIn">
            <p class="text-accent text-xl mb-4">Before you continue, take a quiet breath ü§ç</p>
            <button id="breathe-btn" class="px-6 py-2 rounded-full bg-tech/80 text-darkbg font-bold shadow-glow transition-all duration-500 animate-fadeIn delay-200">Pause & Breathe</button>
            <div id="breathe-overlay" class="fixed inset-0 bg-black/40 flex items-center justify-center z-50 hidden">
              <div class="bg-white/90 rounded-xl p-8 flex flex-col items-center shadow-xl animate-breathe-fade">
                <div id="breathe-count" class="text-5xl font-bold text-accent mb-2 opacity-0 scale-90 transition-all duration-700">5</div>
                <div class="text-tech text-lg mb-2">Breathe in... and out</div>
              </div>
            </div>
          </div>
        `
      },
      {
        title: "Future in Computer Science",
        content: `
          <h2 class="text-2xl font-bold text-accent mb-4 animate-fadeIn">Your Future in Computer Science</h2>
          <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-4">
            <div class="future-card opacity-0 scale-95 transition-all duration-1000 bg-darkbg/80 border border-accent/30 rounded-xl p-6 w-64 flex flex-col items-center">
              <span class="text-3xl mb-2">üß†</span>
              <span class="text-lg font-semibold text-tech mb-1">Problem Solver</span>
              <span class="text-sm text-accent text-center">You see challenges as opportunities to grow.</span>
            </div>
            <div class="future-card opacity-0 scale-95 transition-all duration-1000 bg-darkbg/80 border border-accent/30 rounded-xl p-6 w-64 flex flex-col items-center">
              <span class="text-3xl mb-2">üåç</span>
              <span class="text-lg font-semibold text-tech mb-1">Impact Builder</span>
              <span class="text-sm text-accent text-center">Your work will touch lives and make a difference.</span>
            </div>
            <div class="future-card opacity-0 scale-95 transition-all duration-1000 bg-darkbg/80 border border-accent/30 rounded-xl p-6 w-64 flex flex-col items-center">
              <span class="text-3xl mb-2">ü§ç</span>
              <span class="text-lg font-semibold text-tech mb-1">Purpose-Driven Technologist</span>
              <span class="text-sm text-accent text-center">You build with heart, faith, and intention.</span>
            </div>
          </div>
          <div class="text-center text-tech text-base mb-2 animate-fadeIn delay-200">Computer science needs minds like yours.</div>
          <div class="text-center text-xs text-accent/70 mt-2 animate-fadeIn delay-300">I built this to remind you that your dreams are valid.</div>
          <div class="flex flex-col items-center mt-4">
            <button class="hold-btn px-6 py-2 rounded-full bg-tech/80 text-darkbg font-bold shadow-glow transition-all duration-500 animate-fadeIn delay-400 relative overflow-hidden">
              <span class="hold-btn-label relative z-10">Continue</span>
              <span class="hold-btn-fill absolute left-0 top-0 h-full bg-accent/40 rounded-full z-0" style="width:0%"></span>
            </button>
          </div>
        `
      },
      {
        title: "Birthday Surprise Loading üéÅ",
        content: `
          <h2 class="text-2xl font-bold text-tech mb-2 animate-fadeIn">A Gift Prepared for You</h2>
          <p class="text-accent text-lg mb-6 animate-fadeIn delay-100">Because you are cherished, and your journey matters.</p>
          <div class="w-full flex justify-center mb-4">
            <div class="loader animate-softspin rounded-full h-10 w-10 border-t-4 border-accent/60 border-b-4 border-tech/60"></div>
          </div>
          <div class="flex flex-col items-center">
            <button class="hold-btn px-6 py-2 rounded-full bg-accent/90 text-darkbg font-bold shadow-glow transition-all duration-500 animate-fadeIn delay-200 relative overflow-hidden">
              <span class="hold-btn-label relative z-10">Continue</span>
              <span class="hold-btn-fill absolute left-0 top-0 h-full bg-tech/40 rounded-full z-0" style="width:0%"></span>
            </button>
          </div>
        `
      },
      {
        title: "View Your Voucher üìÑ",
        content: `
          <h2 class="text-2xl font-bold text-accent mb-2 animate-fadeIn">View Your Birthday Voucher</h2>
          <p class="text-tech text-lg mb-6 animate-fadeIn delay-100">See the gift prepared for you with love and purpose.</p>
          <button id="view-voucher" class="px-6 py-2 rounded-full bg-accent/90 text-darkbg font-bold shadow-glow hover:scale-105 hover:bg-tech/80 transition-all duration-500 animate-fadeIn delay-200">View Voucher</button>
        `
      },
      {
        title: "Download Your Voucher ‚¨áÔ∏è",
        content: `
          <h2 class="text-2xl font-bold text-tech mb-2 animate-fadeIn">Download Your Voucher</h2>
          <p class="text-accent text-lg mb-6 animate-fadeIn delay-100">Download your Carrefour voucher (KES 500) and celebrate with peace and joy.</p>
        `
      },
      {
        title: "Congratulations ü§ç",
        content: `
          <h2 class="text-2xl font-bold text-accent mb-2 animate-fadeIn">Happy Birthday Patience</h2>
          <p class="text-tech text-lg mb-6 animate-fadeIn delay-100">May your journey be guided by wisdom and peace.</p>
          <div class="flex flex-col items-center mb-4 animate-fadeIn delay-200">
            <span class="text-4xl">ü§ç</span>
          </div>
        `
      }
    ];

    // Progress bar rendering
    function renderProgress(currentStep) {
      const total = steps.length;
      let html = '';
      for (let i = 0; i < total; i++) {
        html += `
          <div class="flex items-center">
            <div class="w-8 h-8 flex items-center justify-center rounded-full border-2 ${i <= currentStep ? 'border-accent bg-accent text-darkbg' : 'border-tech bg-darkbg text-tech'} font-bold transition-all duration-300">${i+1}</div>
            ${i < total-1 ? `<div class="w-8 h-1 ${i < currentStep ? 'bg-accent' : 'bg-tech/40'} mx-1 rounded transition-all duration-300"></div>` : ''}
          </div>
        `;
      }
      document.getElementById('progress').innerHTML = html;
    }

    // Step content rendering and flow control
    let currentStep = 0;
    let voucherViewed = false;
    let unlockCompleted = false;
    function renderStep(stepIdx) {
      renderProgress(stepIdx);
      const step = steps[stepIdx];
      document.getElementById('step-content').innerHTML = `
        <div class="animate-fadeIn">
          ${step.content}
        </div>
      `;
      setTimeout(() => {
        document.getElementById('step-content').classList.add('opacity-100');
      }, 50);

      // Press-and-hold unlock logic for .hold-btn
      document.querySelectorAll('.hold-btn').forEach((btn, idx, arr) => {
        let fillAnim, startTime;
        const fill = btn.querySelector('.hold-btn-fill');
        const duration = 2000; // 2 seconds
        function startHold(e) {
          if (e) e.preventDefault();
          startTime = Date.now();
          fill.style.transition = 'none';
          fill.style.width = '0%';
          fillAnim = setInterval(() => {
            const elapsed = Date.now() - startTime;
            const percent = Math.min(100, (elapsed / duration) * 100);
            fill.style.width = percent + '%';
            fill.style.transition = 'width 0.1s linear';
            if (percent >= 100) {
              clearInterval(fillAnim);
              btn.classList.add('ring-4','ring-accent/40');
              setTimeout(() => {
                btn.classList.remove('ring-4','ring-accent/40');
              }, 1200);
              // Set unlockCompleted if this is the last hold-btn before download step
              if (stepIdx === 5 || (stepIdx === 6 && arr.length === 1)) unlockCompleted = true;
              setTimeout(() => {
                currentStep++;
                renderStep(currentStep);
              }, 400);
            }
          }, 16);
        }
        function endHold(e) {
          clearInterval(fillAnim);
          fill.style.transition = 'width 0.5s cubic-bezier(.4,0,.2,1)';
          fill.style.width = '0%';
        }
        btn.onmousedown = startHold;
        btn.ontouchstart = startHold;
        btn.onmouseup = endHold;
        btn.onmouseleave = endHold;
        btn.ontouchend = endHold;
      });

      // Pause & Breathe step logic
      if (stepIdx === 3) {
        const breatheBtn = document.getElementById('breathe-btn');
        const overlay = document.getElementById('breathe-overlay');
        const countEl = document.getElementById('breathe-count');
        breatheBtn.addEventListener('click', () => {
          overlay.classList.remove('hidden');
          let count = 5;
          function showCount() {
            countEl.textContent = count;
            countEl.classList.remove('opacity-0','scale-90');
            countEl.classList.add('opacity-100','scale-100');
            setTimeout(() => {
              countEl.classList.remove('opacity-100','scale-100');
              countEl.classList.add('opacity-0','scale-90');
              if (count > 1) {
                setTimeout(() => { count--; showCount(); }, 700);
              } else {
                setTimeout(() => {
                  overlay.classList.add('hidden');
                  setTimeout(() => {
                    currentStep++;
                    renderStep(currentStep);
                  }, 400);
                }, 700);
              }
            }, 700);
          }
          showCount();
        });
      }

      // Reveal cards step logic
      if (stepIdx === 4) {
        const cards = document.querySelectorAll('.future-card');
        cards.forEach((card, i) => {
          setTimeout(() => {
            card.classList.remove('opacity-0','scale-95');
            card.classList.add('opacity-100','scale-100');
          }, 400 + i * 600);
        });
      }

      // View voucher step (now inline)
      if (stepIdx === 6) {
        document.getElementById('view-voucher').addEventListener('click', function() {
          showVoucher();
        });
      }

      // Download voucher step (show inline section)
      if (stepIdx === 7) {
        document.getElementById('voucherSection').style.display = 'block';
      }
    }


    // Show voucher inline and set voucherViewed
    function showVoucher() {
      document.getElementById('voucherSection').style.display = 'block';
      voucherViewed = true;
      setTimeout(() => {
        currentStep++;
        renderStep(currentStep);
      }, 800);
    }

    // --- MICRO-INTERACTIONS & ANIMATIONS ---
    // FadeIn, breathe, and hold-btn animation
    const style = document.createElement('style');
    style.innerHTML = `
      .animate-fadeIn { opacity: 0; animation: fadeIn 1.2s cubic-bezier(.4,0,.2,1) forwards; }
      .animate
      .animate-fadeIn.delay-200 { animation-delay: 0.4s; }
      @keyframes fadeIn { to { opacity: 1; } }
      .loader { border-radius: 50%; border-width: 4px; border-style: solid; border-color: #e879f9 #38bdf8 #e879f9 #38bdf8; }
      .animate-softspin { animation: softspin 4s linear infinite; }
      @keyframes softspin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
      .animate-breathe-fade { animation: breatheFade 0.7s cubic-bezier(.4,0,.2,1); }
      @keyframes breatheFade { from { opacity: 0; transform: scale(0.96);} to { opacity: 1; transform: scale(1);} }
      .hold-btn { position: relative; overflow: hidden; }
      .hold-btn-fill { pointer-events: none; transition: width 0.1s linear; }
      .hold-btn-label { position: relative; z-index: 10; }
    `;
    document.head.appendChild(style);

    // --- INIT ---
    renderStep(currentStep);
  // Remove any old global download button logic if present
  if (document.getElementById('downloadBtn')) {
    document.getElementById('downloadBtn').remove();
  }

  // Magical entrance animation for voucher card
  function showVoucherCardWithMagic() {
    const card = document.getElementById('voucher-card');
    const sparkles = document.getElementById('sparkle-container');
    // Reset
    card.style.opacity = 0;
    card.style.transform = 'scale(0.9)';
    sparkles.innerHTML = '';

    // Animate card in with bounce/scale
    if (window.anime) {
      anime({
        targets: card,
        opacity: [0, 1],
        scale: [0.9, 1.08, 1],
        easing: 'easeOutBack',
        duration: 900,
        delay: 100,
        complete: () => {
          // Sparkle/confetti burst
          for (let i = 0; i < 24; i++) {
            const s = document.createElement('div');
            s.className = 'sparkle';
            const angle = (i / 24) * 2 * Math.PI;
            const radius = 120 + Math.random() * 30;
            s.style.position = 'absolute';
            s.style.left = '50%';
            s.style.top = '50%';
            s.style.width = '10px';
            s.style.height = '10px';
            s.style.borderRadius = '50%';
            s.style.background = ['#e879f9','#38bdf8','#fff','#f472b6'][i%4];
            s.style.opacity = 0.85;
            s.style.zIndex = 3;
            sparkles.appendChild(s);
            anime({
              targets: s,
              translateX: Math.cos(angle) * radius,
              translateY: Math.sin(angle) * radius,
              scale: [1, 0.7 + Math.random()*0.7],
              opacity: [0.85, 0],
              easing: 'easeOutCubic',
              duration: 1100 + Math.random()*400,
              delay: 80 + Math.random()*120,
              complete: () => s.remove()
            });
          }
        }
      });
    } else {
      // fallback: just fade in
      card.style.opacity = 1;
      card.style.transform = 'scale(1)';
    }
  }

  // Call this function when the voucher should appear (after countdown/user action)
  showVoucherCardWithMagic();

  // Download button logic
  document.getElementById('voucher-download').onclick = function() {
    const link = document.createElement('a');
    link.href = 'voucher.pdf';
    link.download = 'Patience_Carrefour_Voucher.pdf';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  };

  // Print button logic
  document.getElementById('voucher-print').onclick = function() {
    const iframe = document.querySelector('#voucher-card iframe');
    if (iframe && iframe.contentWindow) {
      iframe.contentWindow.focus();
      iframe.contentWindow.print();
    } else {
      // fallback: open in new tab and print
      const win = window.open('voucher.pdf', '_blank');
      if (win) win.print();
    }
  };

  </script>
</body>
</html>